

<div class="produto-container">
  <!-- Mensagens de feedback -->
  <div *ngIf="mensagem" class="mensagem sucesso">{{ mensagem }}</div>
  <div *ngIf="mensagemErro" class="mensagem erro">{{ mensagemErro }}</div>

  <!-- Controle de exibição de seções -->
  <div class="menu">
    <button (click)="exibirListaProdutos()">Lista de Produtos</button>
    <button (click)="exibirCriarProduto()">Criar Novo Produto</button>
  </div>

  <!-- Lista de Produtos -->
  <div *ngIf="exibirLista" class="produto-lista">
    <h2>Lista de Produtos</h2>
    <ul>
      <li *ngFor="let produto of produtos" class="produto-item">
        <div class="produto-detalhes">
          <strong>{{ produto.nome }}</strong>
          <p>{{ produto.descricao }}</p>
          <p><strong>Preço:</strong> {{ produto.preco | currency }}</p>
          <p><strong>Quantidade:</strong> {{ produto.quantidade }}</p>
          <p><strong>Categoria:</strong> {{ produto.categoria.nome }}</p>
        </div>
        <div class="produto-acoes">
          <button (click)="deletarProduto(produto.id)" class="btn-deletar">Deletar</button>
          <button (click)="verDetalhes(produto.id)" class="btn-detalhes">Ver Detalhes</button>
          <button (click)="toggleAdicionar(produto.id)" class="btn-adicionar-mais">
            Adicionar Mais
          </button>
        </div>
        <!-- Novo: Campo para adicionar quantidade -->
        <div *ngIf="quantidadesAdicionar[produto.id] !== undefined" class="adicionar-quantidade">
          <input 
            type="number" 
            [(ngModel)]="quantidadesAdicionar[produto.id]" 
            min="1" 
            placeholder="Quantidade a adicionar"
          />
          <button (click)="confirmarAdicionar(produto.id)" class="btn-confirmar">Confirmar</button>
          <button (click)="toggleAdicionar(produto.id)" class="btn-cancelar">Cancelar</button>
        </div>
      </li>
    </ul>
    <div *ngIf="produtos.length === 0" class="sem-produtos">Nenhum produto encontrado.</div>

    <!-- Paginação -->
    <div class="pagination">
      <button (click)="paginaAnterior()" [disabled]="currentPage === 0">Anterior</button>
      <button (click)="proximaPagina()" [disabled]="currentPage === totalPages - 1">Próxima</button>
      <p>Página {{ currentPage + 1 }} de {{ totalPages }}</p>
    </div>
  </div>

  <!-- Formulário de Criação -->
  <div *ngIf="exibirCriar" class="produto-criar">
    <h2>Criar Novo Produto</h2>
    <form [formGroup]="produtoForm" (ngSubmit)="criarProduto()">
      <label for="nome">Nome:</label>
      <input id="nome" formControlName="nome" type="text" />

      <label for="descricao">Descrição:</label>
      <input id="descricao" formControlName="descricao" type="text" />

      <label for="preco">Preço:</label>
      <input id="preco" formControlName="preco" type="number" />

      <label for="quantidade">Quantidade:</label>
      <input id="quantidade" formControlName="quantidade" type="number" />

      <label for="quantidadeMinima">Quantidade Mínima:</label>
      <input id="quantidadeMinima" formControlName="quantidadeMinima" type="number" />

      <label for="categoriaId">Categoria:</label>
      <select id="categoriaId" formControlName="categoriaId">
        <option *ngFor="let categoria of categorias" [value]="categoria.id">
          {{ categoria.nome }}
        </option>
      </select>

      <button type="submit" [disabled]="produtoForm.invalid">Criar Produto</button>
    </form>
  </div>

  <!-- Detalhes do Produto -->
  <div *ngIf="produtoDetalhado" class="produto-detalhado">
    <h2>Detalhes do Produto</h2>
    <p><strong>ID:</strong> {{ produtoDetalhado.id }}</p>
    <p><strong>Nome:</strong> {{ produtoDetalhado.nome }}</p>
    <p><strong>Descrição:</strong> {{ produtoDetalhado.descricao }}</p>
    <p><strong>Preço:</strong> {{ produtoDetalhado.preco | currency }}</p>
    <p><strong>Quantidade:</strong> {{ produtoDetalhado.quantidade }}</p>
    <p><strong>Quantidade Mínima:</strong> {{ produtoDetalhado.quantidadeMinima }}</p>
    <p><strong>Categoria:</strong> {{ produtoDetalhado.categoria.nome }}</p>
    <p><strong>Data de Criação:</strong> {{ produtoDetalhado.dateTime | date:'dd/MM/yy HH:mm' }}</p>
    <button (click)="fecharDetalhes()">Fechar</button>
  </div>
</div>
