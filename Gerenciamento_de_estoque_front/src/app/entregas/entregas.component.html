

<div class="entrega-container">
  <h2>Gerenciamento de Entregas</h2>

  <!-- Mensagens de Sucesso e Erro -->
  <div *ngIf="mensagem" class="alert alert-success">{{ mensagem }}</div>
  <div *ngIf="mensagemErro" class="alert alert-danger">{{ mensagemErro }}</div>

  <!-- Botões de Ação -->
  <div class="action-buttons">
    <button (click)="toggleList()" class="btn btn-primary">
      {{ showList ? 'Ocultar Lista' : 'Mostrar Lista de Entregas' }}
    </button>
    <button (click)="toggleAddForm()" class="btn btn-success">
      {{ showAddForm ? 'Cancelar Adição' : 'Adicionar Nova Entrega' }}
    </button>
  </div>

  <!-- Lista de Entregas -->
  <div *ngIf="showList" class="list-section">
    <!-- Barra de Busca -->
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="applyFilter()"
      placeholder="Buscar entregas..."
      class="search-input"
    />

    <!-- Controle de Paginação -->
    <div class="pagination-controls">
      <button (click)="paginaAnterior()" [disabled]="currentPage === 0">Anterior</button>
      <span>Página {{ currentPage + 1 }} de {{ totalPages }}</span>
      <button (click)="proximaPagina()" [disabled]="currentPage >= totalPages - 1">Próxima</button>
    </div>

    <!-- Tabela de Entregas -->
    <table class="entrega-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Consumidor</th>
          <th>Produto</th>
          <th>Entregador</th>
          <th>Quantidade</th>
          <th>Horário</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entrega of filteredEntregas">
          <td>{{ entrega.id }}</td>
          <td>{{ entrega.nomeConsumidor }}</td>
          <td>{{ entrega.nomeProduto }}</td>
          <td>{{ entrega.nomeEntregador }}</td>
          <td>{{ entrega.quantidade }}</td>
          <td>{{ entrega.horarioEntrega }}</td>
          <td>
            <button (click)="deleteEntrega(entrega.id)" class="btn btn-danger btn-sm">
              Deletar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Formulário de Adição de Entrega -->
  <div *ngIf="showAddForm" class="add-form-section">
    <h3>Registrar Nova Entrega</h3>
    <form (ngSubmit)="submitAddForm()" #entregaForm="ngForm">
      <div class="form-group">
        <label for="produtoId">Produto ID:</label>
        <input
          type="number"
          id="produtoId"
          name="produtoId"
          [(ngModel)]="novaEntrega.produtoId"
          required
          class="form-control"
        />
      </div>

      <div class="form-group">
        <label for="quantidade">Quantidade:</label>
        <input
          type="number"
          id="quantidade"
          name="quantidade"
          [(ngModel)]="novaEntrega.quantidade"
          required
          min="1"
          class="form-control"
        />
      </div>

      <div class="form-group">
        <h4>Dados do Consumidor</h4>
        <label for="nome">Nome:</label>
        <input
          type="text"
          id="nome"
          name="nome"
          [(ngModel)]="nome"
          required
          class="form-control"
        />

        <label for="cpf">CPF:</label>
        <input
          type="text"
          id="cpf"
          name="cpf"
          [(ngModel)]="cpf"
          required
          class="form-control"
        />

        <label for="endereco">Endereço:</label>
        <input
          type="text"
          id="endereco"
          name="endereco"
          [(ngModel)]="endereco"
          required
          class="form-control"
        />
      </div>

      <button type="submit" class="btn btn-success" [disabled]="!entregaForm.form.valid">
        Registrar Entrega
      </button>
    </form>
  </div>
</div>
